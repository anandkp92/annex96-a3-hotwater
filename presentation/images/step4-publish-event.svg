<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 860 340"
     font-family="'Segoe UI','Helvetica Neue',Arial,sans-serif">

  <!-- Header -->
  <rect x="0" y="0" width="860" height="58" fill="#fdedec"/>
  <rect x="0" y="0" width="5" height="340" fill="#e74c3c"/>
  <circle cx="33" cy="29" r="18" fill="#e74c3c"/>
  <text x="33" y="35" text-anchor="middle" font-size="16" font-weight="bold" fill="white">4</text>
  <text x="62" y="23" font-size="17" font-weight="bold" fill="#922b21">Publish Price Signal as an Event</text>
  <text x="62" y="44" font-size="12" fill="#5d6d7e">Package the fetched prices as an OpenADR 3 event and post it to the VTN</text>

  <!-- Column boxes -->
  <rect x="10"  y="64" width="261" height="182" rx="8" fill="#fef7f6" stroke="#f5b7b1" stroke-width="1"/>
  <rect x="281" y="64" width="297" height="182" rx="8" fill="#fde8e4" stroke="#e74c3c" stroke-width="1.5"/>
  <rect x="588" y="64" width="261" height="182" rx="8" fill="#f0fcf5" stroke="#abebc6" stroke-width="1"/>

  <!-- Column labels -->
  <text x="140" y="80" text-anchor="middle" font-size="10" font-weight="bold" fill="#2980b9"  letter-spacing="1.5">INPUTS</text>
  <text x="429" y="80" text-anchor="middle" font-size="10" font-weight="bold" fill="#922b21"  letter-spacing="1.5">WHAT IT DOES</text>
  <text x="718" y="80" text-anchor="middle" font-size="10" font-weight="bold" fill="#1e8449"  letter-spacing="1.5">OUTPUTS</text>

  <!-- Inputs -->
  <text x="20" y="99"  font-size="11" font-weight="bold" fill="#2471a3">● prices + start_time (Step 2)</text>
  <text x="28" y="113" font-size="10" fill="#5d6d7e">hourly prices and window start</text>
  <text x="20" y="130" font-size="11" font-weight="bold" fill="#2471a3">● program_id (Step 3)</text>
  <text x="28" y="144" font-size="10" fill="#5d6d7e">links event to program</text>
  <text x="20" y="161" font-size="11" font-weight="bold" fill="#2471a3">● OAuth token (Step 1)</text>
  <text x="28" y="175" font-size="10" fill="#5d6d7e">via bl_headers()</text>

  <!-- Action -->
  <text x="429" y="96"  text-anchor="middle" font-size="11" fill="#5d6d7e">Format each hour as an interval:</text>
  <rect x="296" y="102" width="265" height="30" rx="5" fill="#e74c3c" opacity="0.1"/>
  <text x="429" y="115" text-anchor="middle" font-size="10" fill="#922b21" font-family="monospace">{id: hour, payloads: [{type:</text>
  <text x="429" y="128" text-anchor="middle" font-size="10" fill="#922b21" font-family="monospace">"PRICE", values: [price]}]}</text>
  <line x1="320" y1="140" x2="538" y2="140" stroke="#f5b7b1" stroke-width="1" stroke-dasharray="4,3"/>
  <rect x="292" y="148" width="274" height="28" rx="6" fill="#e74c3c" opacity="0.18"/>
  <text x="429" y="166" text-anchor="middle" font-size="12" font-weight="bold" fill="#922b21">POST /events</text>
  <text x="429" y="183" text-anchor="middle" font-size="11" fill="#5d6d7e">Event stored on VTN server</text>
  <text x="429" y="199" text-anchor="middle" font-size="11" fill="#5d6d7e">Any auth'd VEN can now read it</text>
  <text x="429" y="218" text-anchor="middle" font-size="11" fill="#5d6d7e">via GET /events (Step 5)</text>

  <!-- Outputs -->
  <text x="598" y="99"  font-size="11" font-weight="bold" fill="#1e8449">● event_id</text>
  <text x="606" y="113" font-size="10" fill="#5d6d7e">stored event identifier on VTN</text>
  <text x="598" y="130" font-size="11" font-weight="bold" fill="#1e8449">● N intervals on VTN</text>
  <text x="606" y="144" font-size="10" fill="#5d6d7e">queryable by all VENs</text>
  <text x="598" y="161" font-size="11" font-weight="bold" fill="#1e8449">● Linked to program_id</text>
  <text x="606" y="175" font-size="10" fill="#5d6d7e">VENs can filter by program</text>
  <text x="598" y="192" font-size="11" font-weight="bold" fill="#1e8449">● HTTP 201 confirmed</text>
  <text x="606" y="206" font-size="10" fill="#5d6d7e">raised if creation fails</text>

  <!-- Customize footer -->
  <rect x="0" y="252" width="860" height="88" fill="#f8f9fa"/>
  <line x1="5" y1="252" x2="860" y2="252" stroke="#d5dbdb" stroke-width="1"/>
  <text x="14" y="268" font-size="10" font-weight="bold" fill="#7f8c8d" letter-spacing="1.5">CUSTOMIZE</text>
  <text x="14" y="283" font-size="11" fill="#5d6d7e">→ Interval duration: "PT1H" (1 hr default) — OpenADR 3 also supports "PT15M" for 15-minute intervals</text>
  <text x="14" y="298" font-size="11" fill="#5d6d7e">→ Price rounding: round(price, 5) — adjust decimal places to match utility data precision requirements</text>
  <text x="14" y="313" font-size="11" fill="#5d6d7e">→ Multiple events: publish separate events per tariff zone, VEN group, or building type</text>
  <text x="14" y="328" font-size="11" fill="#5d6d7e">→ Event expiry: set intervalPeriod.duration to automatically expire stale events on the VTN</text>
</svg>
